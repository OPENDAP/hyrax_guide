sudo: required
branches:
  only:
  - main
env:
  global:
  # GIT_USER_EMAIL  
  - secure: HdfxfrRpUfGYKyfvs9MS3rS28Se77kSIWtvRN+zcsHSSmbVgqsPhHPs4FJ6cJm5iAjfTX/865RB/JEV+3Pof0SvYpHBFfbPTOpLU+eNv7r1891hEo3Ueuo77nEwb/CjpAtsPfK/FJ3dLhEroBPb8g92gxncMr26WO+grP2SR4yvwQj844WJzSHrC5roGoxciuzJlNtjgdJ0xehUVxNv5N0Q2gcO3uqtwMOBezUiTPFx4kGDCsEb5r7RE99X1FdFbrh8IA7p8ZmukBy3SdIqf9MOXQno58DsSOL1hj0iZ86x1p1qAiroAkZK3rLa3j1hI6fhbvUZ+uPoVssHrjiCTxJwer6M0YJsUZJOzVPk6OCdS5oaOCvKVDDUa3L006zuDXqQQArBOxf9eKIWVx2IRpVN3Su2AV2vhyf3Mrb956x7QvzaJcKmEi0DiJHt9hu0uc1zyivxXBy7Z9VwOnWkXu4eBEyPT4kqhKiUGhPWvNqr5uQSe4ush3EPgoOcWNt7BtLe9vqfpeqWPvekTJdG8axMW0Fgfhz9vZ/eRP4oTYXUfiasr2LqPq8jXdjxpP1eD7hBG6qy02kNj8Xht6G4w4d+QlE0eOIAJC3y3JxwFDeOCLm2U9JdQNX7MZWAvdgVUfLiVXnW6tKc4xuf4U9+3xvUXwxNw+wBbNBTmgrtCbXI=
  # GIT_USER_NAME
  - secure: LGVGf0IVmeRLIeF8NDHpG/WLaD5eStqAWBib/1Ea+LN6yBwNZndG52R32jiXXpENaZdhlwBMYv8K/mQDZAhZlDlSQ1JoLg4Q08R60Jx3ZHWNfNcPs8PhgUh8e71hEfPMNIxcoiJlXtWq3oAX+saTsjhwtxh7H8hQ93Xa9tz/6dDoA0WsR2NOcW7vjNgxmq3337wUQuMGMhSZZGy3kddoTQe/I1kvcQDFHY4kK0uScI61Y9k3Y0eaSf+UEyw6bcwIwalVkYadJhyLGWojcHCav233t2ox6OH0lPkLfvyuohH9XTKBWPQJ5VVdsLLLK0aVztYNIDDupbVIRahX6zVlxHocwC4RqHwZ4sHhkYXYI5r2mqfQFWWvtGcEM8fxDGdHr2JI7u7mm0BJHPHBcUNHcqqxlyKPwDXajRPH+K6cP7MmyTsWFCNzHqpF7+b35MQQyJZj+YsEdsEuWtpnrONfvTByRu9gXHithxjfSXsGKk6Btpi6pyfmdbJxRUnv+OVjJNokJagx9/RliBpNDIFJBb/wsb7R96WUQbs5t2y+i217+Eov3yKgu6rslUMRH93/Ami+Dwk7oLWhaWo8WtO9by0BRBghM1IFyhQedeFCd8+O7KKDm+tNY0pJ4d0kbU+FV/JnQ4neb1KY3zTO72MAL5Xb1Q8aWnyAbC2EwPYr+qI=
  # GIT_UID
  - secure: l+Nh3HrIYULB84YoeGFpIMau7RZ+FnvwF6jqAEv9UbTvpNJCvcZWjNsjlpfZUIrFe4muG2qJdUn0iu/9nBjZXmKHH61P2SogF56lczLo/aJGIDr/sIbOHgGsb2nWbiGXjOGgm0QAeIyFRMOEc0mE7rXtGTL+5xuxn0blf91BVGPh12yHr0+kV9EtztnztYGpIt+wp7cEufEnk3YlkyFszu12Jlcfn3yVEhzNj9ksREtzLrUluVTDuQY3H8Kk7eH35eKrVJQdpqZIldtODEPKh3WEPFQ63wzGjYGTM7jV9SO1Q89COcBWoWj+EjpzjYERp25cu9wYfRakLfTh8tYXbRctX5thYV3qjco30t88A2ivWMOeilfi1OnZM94NFcYLZRtkE+4GOQjV6l5mytfEGL4MkpbiSUsA2NOQ/WaUxmGf9/LMpwpC6fTyZQ3zTreVRzXK8YnYWMpU/RFVTLRTlMyr7QUpnd89illf2TKupcTyVu9zUMaHnwwArM4w4vW+Xn2zYb1GHfiFWoiyktwz1+pUpOK1Lk2Z/YRDg7RtQRbDKO0slvCh1TfzcHTan/YfteLCRQWina6yrm4Pf6FCVd0oXq287TRHrP0FuLWzLEbLTaqsccFp/v7aOyG6oYuZntnxSU82ovmn6v3FdacMfuWokU4OR3SG8HSggMO7KuA=
  # GIT_TOKEN
  - secure: DDSrtnt8x+vEYJF4kDhGQWCLvzDYbni6v0sWR+eh2h1tfUMWVblAHLIq+BR4GTg1uEhKxGbEhCMeNda/FE/mubnjx512RkGZyJYdCEPbwNN9pxDm7Duh24mSubMZeLWmTgJeC9oV7sFq28/3p7xk0oUhQMLujZjE2Fx3XK7BqmUS+Uyes3S6EORkODcJkkyTQwMFbgVOJDZYelrSqi18cAk7cOg9erJcHLEdqh7dtQeNa1XcS3VttK99JBzNtF/B/G3naRLpf5Vh2LCWv9HMxcu/XDFXR8IWEai14PqJNzImFRAUh4Ex7TaeWlOJ878/ahg85vR3A3ywtjGoYjNTo9p8k140EBx1irbj0FEXdIvVfOhjxMG30GWz2ZtNJSWbYoiXO2BskmmNuXENgMoy2ytI0POPjZ6joaIov/pR5aitbY6Xe2MTwVXiRIYPk5tPKucz9BGpUHnPMzNoCD3x/g11AJewBMKzZe6mCZNnYW3oAgbXnBQ4m0BaHoh/Cd0TpNOQP/hNC8pgoRi2GmpxywjMcpDTmOFMT8JchHXlqyGNVRmikSCsMG2Sfzmv9hkCJQznu6C+UW1H5rfUPUQwUQ1FaVCYRVjJY88re4C1PIVl/bKIacENzs+kblnfpxF07Q17P3zPNGCj4Yfgomk5O3ZvBIIarrRdm5tgOuT8AKM=

notifications:
  email:
  - ndp@opendap.org
  - jgallagher@opendap.org
  - "{GIT_USER_EMAIL}"

services:
- docker
before_install:
- mkdir -p output
- docker pull asciidoctor/docker-asciidoctor
script:
- GUIDE_VERSION=`cat VERSION`"-${TRAVIS_BUILD_NUMBER}"
- echo ${GUIDE_VERSION}
- cat Master_Hyrax_Guide.adoc | sed -e "s|GUIDE_VERSION|${GUIDE_VERSION}|g" > index.adoc
- docker run -v $TRAVIS_BUILD_DIR:/documents/ --name asciidoc-to-html asciidoctor/docker-asciidoctor
  asciidoctor -a toc=left -a docinfo=shared -D /documents/output index.adoc
- mv ./output/index.html ./output/Master_Hyrax_Guide.html
after_error:
- docker logs asciidoc-to-html
after_failure:
- docker logs asciidoc-to-html
after_success:
- ./travis/deploy_to_gh_pages.sh
